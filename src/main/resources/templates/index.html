<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Job Tracker UA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body class="bg-light">

<div class="container py-5">
    <h1 class="mb-4 text-center">Job Tracker <small class="text-muted">UA</small></h1>

    <div th:if="${message}" class="alert alert-dismissible fade show"
         th:classappend="${'alert-' + messageType}" role="alert">
        <span th:text="${message}">–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è</span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <div class="card shadow-sm mb-5">
        <div class="card-body">
            <h5 class="card-title mb-3">–ü–æ—à—É–∫ –≤–∞–∫–∞–Ω—Å—ñ–π</h5>

            <form action="/parse" method="post" class="row g-3">

                <div class="col-md-4">
                    <label class="form-label visually-hidden">–ü–æ—à—É–∫</label>
                    <input type="text" name="query" class="form-control" placeholder="–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—è (–Ω–∞–ø—Ä. Java, Python)" required>
                </div>

                <div class="col-md-2">
                    <label class="form-label visually-hidden">–ú—ñ—Å—Ç–æ</label>
                    <select name="city" class="form-select">
                        <option value="">–í—Å—ñ –º—ñ—Å—Ç–∞</option>
                        <option value="Remote">–í—ñ–¥–¥–∞–ª–µ–Ω–æ</option>
                        <hr>
                        <option value="Kyiv">–ö–∏—ó–≤</option>
                        <option value="Lviv">–õ—å–≤—ñ–≤</option>
                        <option value="Dnipro">–î–Ω—ñ–ø—Ä–æ</option>
                        <option value="Kharkiv">–•–∞—Ä–∫—ñ–≤</option>
                        <option value="Odesa">–û–¥–µ—Å–∞</option>
                        <option value="Vinnytsia">–í—ñ–Ω–Ω–∏—Ü—è</option>
                        <option value="Ivano-Frankivsk">–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫</option>
                        <option value="Uzhhorod">–£–∂–≥–æ—Ä–æ–¥</option>
                        <option value="Ternopil">–¢–µ—Ä–Ω–æ–ø—ñ–ª—å</option>
                        <option value="Chernivtsi">–ß–µ—Ä–Ω—ñ–≤—Ü—ñ</option>
                        <option value="Lutsk">–õ—É—Ü—å–∫</option>
                        <option value="Rivne">–†—ñ–≤–Ω–µ</option>
                        <option value="Khmelnytskyi">–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π</option>
                        <option value="Zhytomyr">–ñ–∏—Ç–æ–º–∏—Ä</option>
                        <option value="Poltava">–ü–æ–ª—Ç–∞–≤–∞</option>
                        <option value="Cherkasy">–ß–µ—Ä–∫–∞—Å–∏</option>
                        <option value="Zaporizhzhia">–ó–∞–ø–æ—Ä—ñ–∂–∂—è</option>
                        <option value="Mykolaiv">–ú–∏–∫–æ–ª–∞—ó–≤</option>
                        <option value="Chernihiv">–ß–µ—Ä–Ω—ñ–≥—ñ–≤</option>
                        <option value="Sumy">–°—É–º–∏</option>
                        <option value="Kropyvnytskyi">–ö—Ä–æ–ø–∏–≤–Ω–∏—Ü—å–∫–∏–π</option>
                        <hr>
                        <option value="Krakow">–ö—Ä–∞–∫—ñ–≤ (PL)</option>
                        <option value="Warsaw">–í–∞—Ä—à–∞–≤–∞ (PL)</option>
                        <option value="Relocate">Relocate (–ó–∞ –∫–æ—Ä–¥–æ–Ω)</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <label class="form-label visually-hidden">–î–æ—Å–≤—ñ–¥</label>
                    <select name="level" class="form-select">
                        <option value="0">–ë–µ–∑ –¥–æ—Å–≤—ñ–¥—É</option>
                        <option value="1">1 —Ä—ñ–∫</option>
                        <option value="2">2 —Ä–æ–∫–∏</option>
                        <option value="3">3 —Ä–æ–∫–∏</option>
                        <option value="5">5+ —Ä–æ–∫—ñ–≤</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <label class="form-label visually-hidden">English</label>
                    <select name="english" class="form-select">
                        <option value="no_english">–ë–µ–∑ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—ó</option>
                        <option value="pre">Pre-Intermediate</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="upper">Upper-Intermediate</option>
                        <option value="fluent">Advanced / Fluent</option>
                    </select>
                </div>

                <div class="col-md-2">
                    <button type="submit" class="btn btn-primary w-100">–ó–Ω–∞–π—Ç–∏</button>
                </div>

                <div class="col-12 mt-3">
                    <div class="d-flex align-items-center bg-light p-2 rounded border">
                        <span class="fw-bold me-3 text-secondary">–î–µ —à—É–∫–∞—Ç–∏:</span>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="sources" value="DOU" id="sourceDou" checked>
                            <label class="form-check-label" for="sourceDou">DOU.ua</label>
                        </div>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="sources" value="Djinni" id="sourceDjinni" checked>
                            <label class="form-check-label" for="sourceDjinni">Djinni.co</label>
                        </div>
                    </div>
                </div>

            </form>
        </div>
    </div>

    <div class="card shadow-sm mb-5 border-warning" th:if="${!favorites.isEmpty()}">
        <div class="card-header bg-warning-subtle">
            <h5 class="mb-0 text-dark"><i class="bi bi-star-fill text-warning"></i> –û–±—Ä–∞–Ω—ñ –≤–∞–∫–∞–Ω—Å—ñ—ó</h5>
        </div>
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                <tr>
                    <th>–ü–æ—Å–∞–¥–∞</th>
                    <th>–ö–æ–º–ø–∞–Ω—ñ—è</th>
                    <th>–†–µ—Å—É—Ä—Å</th>
                    <th>–ú—ñ—Å—Ç–æ</th>
                    <th>–†–æ–∫—ñ–≤ –¥–æ—Å–≤—ñ–¥—É</th>
                    <th>English</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î—ñ—ó</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="v : ${favorites}">
                    <td>
                        <a th:href="@{/view/{id}(id=${v.id})}" class="fw-bold text-decoration-none" th:text="${v.title}">Title</a>
                        <br>
                        <small class="text-muted" th:text="${v.salary}">Salary</small>
                    </td>
                    <td th:text="${v.company}">Company</td>

                    <td><span class="badge bg-light text-dark border" th:if="${v.source != null}" th:text="${v.source.name}">SRC</span></td>
                    <td><span class="badge bg-info text-dark" th:if="${v.city != null}" th:text="${v.city}">City</span></td>

                    <td>
                        <span class="badge bg-secondary" th:if="${v.level != null && !#strings.isEmpty(v.level)}">
                            <i class="bi bi-briefcase-fill me-1"></i> <span th:switch="${v.level}">
                                <span th:case="'0'">–ë–µ–∑ –¥–æ—Å–≤—ñ–¥—É</span>
                                <span th:case="'1'">1 —Ä—ñ–∫</span>
                                <span th:case="'2'">2 —Ä–æ–∫–∏</span>
                                <span th:case="'3'">3 —Ä–æ–∫–∏</span>
                                <span th:case="'4'">4 —Ä–æ–∫–∏</span>
                                <span th:case="'5'">5 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'6'">6 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'7'">7 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'8'">8 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'9'">9 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'10'">10 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="*" th:text="${#strings.capitalize(v.level)}">Junior</span>
                            </span>
                        </span>
                        <small class="text-muted" th:if="${v.level == null || #strings.isEmpty(v.level)}">-</small>
                    </td>

                    <td>
                        <span class="badge bg-warning-subtle text-dark border"
                              th:if="${v.englishLevel != null && v.englishLevel != ''}">
                              <i class="bi bi-translate me-1"></i> <span th:text="${v.englishLevel}">Upper</span>
                        </span>
                        <small class="text-muted" th:if="${v.englishLevel == null || v.englishLevel == ''}">-</small>
                    </td>

                    <td>
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"
                                    th:text="${v.status}"
                                    th:classappend="${v.status.name() == 'NEW' ? 'btn-primary' :
                                 (v.status.name() == 'APPLIED' ? 'btn-warning' :
                                 (v.status.name() == 'INTERVIEW' ? 'btn-info' :
                                 (v.status.name() == 'OFFER' ? 'btn-success' :
                                 (v.status.name() == 'REJECTED' ? 'btn-danger' : 'btn-secondary'))))}">
                                Status
                            </button>
                            <ul class="dropdown-menu">
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="NEW" class="dropdown-item">üÜï –ù–æ–≤–∞</button></form></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="APPLIED" class="dropdown-item">üì§ –í—ñ–¥–≥—É–∫–Ω—É–≤—Å—è</button></form></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="INTERVIEW" class="dropdown-item">üé§ –°–ø—ñ–≤–±–µ—Å—ñ–¥–∞</button></form></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="OFFER" class="dropdown-item">üéâ –û—Ñ—Ñ–µ—Ä</button></form></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="REJECTED" class="dropdown-item text-danger">‚õî –í—ñ–¥–º–æ–≤–∞</button></form></li>
                            </ul>
                        </div>
                    </td>

                    <td>
                        <a th:href="@{/favorite/{id}(id=${v.id})}" class="btn btn-sm btn-outline-danger" title="–ü—Ä–∏–±—Ä–∞—Ç–∏ –∑ –æ–±—Ä–∞–Ω–∏—Ö"><i class="bi bi-trash"></i></a>
                        <a th:href="@{/view/{id}(id=${v.id})}" class="btn btn-sm btn-outline-dark">–î–µ—Ç–∞–ª—ñ</a>
                        <a th:href="${v.link}" target="_blank" class="btn btn-sm btn-outline-primary">–ù–∞ —Å–∞–π—Ç ‚Üó</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="card shadow-sm">
        <div class="card-header bg-white">
            <h5 class="mb-0">üìã –í—Å—ñ –∑–Ω–∞–π–¥–µ–Ω—ñ –≤–∞–∫–∞–Ω—Å—ñ—ó</h5>
        </div>
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                <tr>
                    <th>–ü–æ—Å–∞–¥–∞</th>
                    <th>–ö–æ–º–ø–∞–Ω—ñ—è</th>
                    <th>–†–µ—Å—É—Ä—Å</th>
                    <th>–ú—ñ—Å—Ç–æ</th>
                    <th>–†–æ–∫—ñ–≤ –¥–æ—Å–≤—ñ–¥—É</th>
                    <th>English</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î—ñ—ó</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="v : ${vacancies}">
                    <td>
                        <a th:href="@{/view/{id}(id=${v.id})}" class="fw-bold text-decoration-none" th:text="${v.title}">Title</a>
                        <br>
                        <small class="text-muted" th:text="${v.salary}">Salary</small>
                    </td>
                    <td th:text="${v.company}">Company</td>

                    <td><span class="badge bg-light text-dark border" th:if="${v.source != null}" th:text="${v.source.name}">SRC</span></td>
                    <td><span class="badge bg-info text-dark" th:if="${v.city != null}" th:text="${v.city}">City</span></td>

                    <td>
                        <span class="badge bg-secondary" th:if="${v.level != null && !#strings.isEmpty(v.level)}">
                            <i class="bi bi-briefcase-fill me-1"></i> <span th:switch="${v.level}">
                                <span th:case="'0'">–ë–µ–∑ –¥–æ—Å–≤—ñ–¥—É</span>
                                <span th:case="'1'">1 —Ä—ñ–∫</span>
                                <span th:case="'2'">2 —Ä–æ–∫–∏</span>
                                <span th:case="'3'">3 —Ä–æ–∫–∏</span>
                                <span th:case="'4'">4 —Ä–æ–∫–∏</span>
                                <span th:case="'5'">5 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'6'">6 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'7'">7 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'8'">8 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'9'">9 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="'10'">10 —Ä–æ–∫—ñ–≤</span>
                                <span th:case="*" th:text="${#strings.capitalize(v.level)}">Junior</span>
                            </span>
                        </span>
                        <small class="text-muted" th:if="${v.level == null || #strings.isEmpty(v.level)}">-</small>
                    </td>

                    <td>
                        <span class="badge bg-warning-subtle text-dark border"
                              th:if="${v.englishLevel != null && v.englishLevel != ''}">
                              <i class="bi bi-translate me-1"></i> <span th:text="${v.englishLevel}">Upper</span>
                        </span>
                        <small class="text-muted" th:if="${v.englishLevel == null || v.englishLevel == ''}">-</small>
                    </td>

                    <td>
                        <div class="btn-group">
                            <button type="button" class="btn btn-sm dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"
                                    th:text="${v.status}"
                                    th:classappend="${v.status.name() == 'NEW' ? 'btn-primary' :
                                 (v.status.name() == 'APPLIED' ? 'btn-warning' :
                                 (v.status.name() == 'INTERVIEW' ? 'btn-info' :
                                 (v.status.name() == 'OFFER' ? 'btn-success' :
                                 (v.status.name() == 'REJECTED' ? 'btn-danger' : 'btn-secondary'))))}">
                                Status
                            </button>
                            <ul class="dropdown-menu">
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="NEW" class="dropdown-item">üÜï –ù–æ–≤–∞</button></form></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="APPLIED" class="dropdown-item">üì§ –í—ñ–¥–≥—É–∫–Ω—É–≤—Å—è</button></form></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="INTERVIEW" class="dropdown-item">üé§ –°–ø—ñ–≤–±–µ—Å—ñ–¥–∞</button></form></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="OFFER" class="dropdown-item">üéâ –û—Ñ—Ñ–µ—Ä</button></form></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><form action="/status/update" method="post"><input type="hidden" name="id" th:value="${v.id}"><button type="submit" name="status" value="REJECTED" class="dropdown-item text-danger">‚õî –í—ñ–¥–º–æ–≤–∞</button></form></li>
                            </ul>
                        </div>
                    </td>

                    <td>
                        <a th:href="@{/favorite/{id}(id=${v.id})}" class="btn btn-sm"
                           th:classappend="${v.isFavorite == true} ? 'btn-warning' : 'btn-outline-secondary'">
                            <i th:class="${v.isFavorite == true} ? 'bi bi-star-fill' : 'bi bi-star'"></i>
                        </a>
                        <a th:href="@{/view/{id}(id=${v.id})}" class="btn btn-sm btn-outline-dark">–î–µ—Ç–∞–ª—ñ</a>
                        <a th:href="${v.link}" target="_blank" class="btn btn-sm btn-outline-primary">–ù–∞ —Å–∞–π—Ç ‚Üó</a>
                    </td>
                </tr>
                <tr th:if="${vacancies.isEmpty()}">
                    <td colspan="8" class="text-center py-4 text-muted">
                        –°–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π. –°–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—à—É–∫–∞—Ç–∏ –≤–∞–∫–∞–Ω—Å—ñ—ó!
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>